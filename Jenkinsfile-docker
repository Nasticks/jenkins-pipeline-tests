pipeline {
    agent any

    environment {
        GIT_CREDENTIALS = 'github' // Le nom des credentials que vous avez configurés dans Jenkins
    }

    stages {
        stage('Checkout') {
            steps {
                // Checkout the code from your repository
                git branch: 'main', url: 'https://github.com/Nasticks/jenkins-pipeline-tests.git', credentialsId: env.GIT_CREDENTIALS
            }
        }
        
        stage('Build') {
            steps {
                script {
                    // No build steps are needed for a simple Hello World
                    dockerImage = docker.build("simple-web-server:latest")
                }
            }
        }
        stage('Run Docker Container') {
            steps {
                // Exécuter le conteneur Docker
                script {
                    dockerImage.run('-p 8000:8000')
                }
            }
        }
    }
    }










// pipeline {
//     agent {
//         label 'jenkins-Agent'
//     }
//     stages {
//         stage('Checkout') {
//             steps {
//                 // Cloner le dépôt Git
//                 git 'https://github.com/Nasticks/jenkins-pipeline-tests.git'
//             }
//         }
//         stage('Build Docker Image') {
//             steps {
//                 // Construire l'image Docker
//                 script {
//                     dockerImage = docker.build("simple-web-server:latest")
//                 }
//             }
//         }
//         stage('Run Docker Container') {
//             steps {
//                 // Exécuter le conteneur Docker
//                 script {
//                     dockerImage.run('-p 8000:8000')
//                 }
//             }
//         }
//     }
//     post {
//         always {
//             echo 'Pipeline completed par precieux.'
//         }
//     }
// }
